#! /usr/bin/python
# -*- coding: utf-8 -*-

import sys
import os

BASE_DIR = os.path.abspath( os.path.join( os.path.dirname( __file__ ), ".." ) )
path     = os.path.abspath( os.path.join( BASE_DIR, "python" ) )
sys.path.append( path )

import momo
import random
import numpy as np

def learn( name, cost_function ):
  f = open( name, "w" )
  cost_function.save( f )
  f.close()

random.seed( 0 )

data     = momo.read_data( "data/filtered/%s.txt" % sys.argv[1] )
features = momo.features.__dict__[sys.argv[2]] 
cost_function = momo.cost_functions.__dict__[sys.argv[3]]

start_path = "data/models/%s/%s" % ( sys.argv[2], sys.argv[3] )
if not os.path.exists( start_path ):
  os.makedirs( start_path )

output_name = "%s/%s.txt" % ( start_path, sys.argv[1] )

cf = cost_function( features, data )
learn( 
  output_name,
  #cost_function( features, data[:10000] )#, 10 )
  cf
)

print cf.mu
